/*----------------------------------------------------------------------------*/
/* Copyright (c) FIRST 2008. All Rights Reserved.                             */
/* Open Source Software - may be modified and shared by FRC teams. The code   */
/* must be accompanied by the FIRST BSD license file in the root directory of */
/* the project.                                                               */
/*----------------------------------------------------------------------------*/

package org.usfirst.frc.team1672.robot;

import edu.wpi.first.wpilibj.SampleRobot;
import edu.wpi.first.wpilibj.Joystick;
import edu.wpi.first.wpilibj.RobotDrive;
import edu.wpi.first.wpilibj.Talon;
import edu.wpi.first.wpilibj.Jaguar;
import edu.wpi.first.wpilibj.Timer;
import edu.wpi.first.wpilibj.Ultrasonic;
import edu.wpi.first.wpilibj.vision.AxisCamera;
import edu.wpi.first.wpilibj.smartdashboard.SmartDashboard;
import edu.wpi.first.wpilibj.smartdashboard.SendableChooser;
import edu.wpi.first.wpilibj.Gyro;

//import edu.wpi.first.wpilibj.buttons.JoystickButton; Not needed (using raw input)


/**
 * The VM is configured to automatically run this class, and to call the
 * functions corresponding to each mode, as described in the SimpleRobot
 * documentation. If you change the name of this class or the package after
 * creating this project, you must also update the manifest file in the resource
 * directory.
 */
public class Robot extends SampleRobot {
	
    /**
     * This function is called once each time the robot enters autonomous mode.
     */
	
		 Joystick driveStick = new Joystick(0);
		 Joystick liftStick = new Joystick(1);
		 
		 public static Gyro roboGyro = new Gyro(10);
		 double robotDegrees = roboGyro.getAngle();
		 
		 SmartDashboard dash = new SmartDashboard();
		 SendableChooser autoChooser = new SendableChooser();
		 
		 AxisCamera cam1 = new AxisCamera("10.16.72.2");
		 
		 public static AxisCamera.Resolution k640x360;
	
		 RobotDrive chassis = new RobotDrive(0, 1, 2, 3);
		 
		 Talon frontLeft = new Talon(0);
		 Talon frontRight = new Talon(1);
		 Talon rearLeft = new Talon(2);
		 Talon rearRight = new Talon(3);
		 
		 LiftOperator lifter = new LiftOperator();
		 AutoLibrary autoLib = new AutoLibrary();
		 
		 RobotDrive liftDriver = new RobotDrive(5,6);
		 
		 Jaguar lift1 = new Jaguar(5);
		 Jaguar lift2 = new Jaguar(6);
		 
		 public final double GROUND_SENSOR_DISTANCE = 0.1; //ground level
		 public final double FIRST_SENSOR_DISTANCE = 12.1; //1st level
		 public final double SECOND_SENSOR_DISTANCE = 24.2; //2nd level
		 public final double THIRD_SENSOR_DISTANCE = 36.3; //3rd level
		 public final double FOURTH_SENSOR_DISTANCE = 48.4; //4th level
		 public final double FIFTH_SENSOR_DISTANCE = 56; //5th level (container)
		 
		 Ultrasonic liftSensor = new Ultrasonic(7, 7);
		 public static double liftHeight; //in inches | totes = 12.1 in, containers = 29 in
		 public static double desiredHeight;
		 
		 boolean isLiftReady = false;
		 boolean stopLoop = false;
		 
		 public void robotInit() {
		    	chassis.setInvertedMotor(RobotDrive.MotorType.kFrontLeft, true);
		    	chassis.setInvertedMotor(RobotDrive.MotorType.kRearLeft, true);
		    	
				liftSensor.setAutomaticMode(true);
				liftSensor.setEnabled(true);
				
				liftDriver.setInvertedMotor(RobotDrive.MotorType.kFrontRight, true);
				
				autoChooser.addDefault("Right", new Thread("auto1"));
				autoChooser.addObject("Middle", new Thread("auto2"));
				autoChooser.addObject("Left", new Thread("auto3"));
				SmartDashboard.putData("Autonomous Code Chooser", autoChooser);
		 }
		 
		 String chosenAuto;
		 
		 public void autonomousInit() {
			 chosenAuto = (String) autoChooser.getSelected();
		 }
	
    public void autonomous() {
    	
    	chassis.setSafetyEnabled(false);
    	
    	if(chosenAuto.equals("auto1")) {
    		autoLib.runAuto1();
    	} else if(chosenAuto.equals("auto2")) {
    		autoLib.runAuto2();
    	} else {
    		autoLib.runAuto3();
    	}
    }

    /**
     * This function is called once each time the robot enters operator control.
     */
    public void operatorControl() {
			liftSensor.setAutomaticMode(true);
			liftSensor.setEnabled(true);

			Thread driveThread = new Thread() {
				public void start() {
				}
				public void run() {
					chassis.mecanumDrive_Polar(driveStick.getMagnitude(), driveStick.getDirectionDegrees(), driveStick.getTwist());
				}
			};
			
			Thread liftThread = new Thread() {
				private Joystick liftStick;
				public void start(){
					liftStick = new Joystick(1);
				}
				public void run() {
					if(liftStick.getTrigger()){
						lifter.toGround();
						while(liftHeight >= (desiredHeight + 2) || liftHeight <= (desiredHeight - 2) && stopLoop == false) {
								lifter.toGround();
								lifter.getLiftInput();
							}
						stopLoop = false;
						}
					if(liftStick.getRawButton(2)) {
						lifter.toFirst();
						while(liftHeight >= (desiredHeight + 2) || liftHeight <= (desiredHeight - 2) && stopLoop == false) {
								lifter.toFirst();
								lifter.getLiftInput();
							}
						stopLoop = false;
						}
						if(liftStick.getRawButton(3)) {
						lifter.toSecond();
						while(liftHeight >= (desiredHeight + 2) || liftHeight <= (desiredHeight - 2) && stopLoop == false) {
								lifter.toSecond();
								lifter.getLiftInput();
							}
						stopLoop = false;
						}
						if(liftStick.getRawButton(4)) {
						lifter.toThird();
						while(liftHeight >= (desiredHeight + 2) || liftHeight <= (desiredHeight - 2) && stopLoop == false) {
								lifter.toThird();
								lifter.getLiftInput();
							}
						stopLoop = false;
						}
						if(liftStick.getRawButton(5)) {
						lifter.toFourth();
						while(liftHeight >= (desiredHeight + 2) || liftHeight <= (desiredHeight - 2) && stopLoop == false) {
								lifter.toFourth();
								lifter.getLiftInput();
							}
						stopLoop = false;
						}
						if(liftStick.getRawButton(10)) {
						lifter.toFifth();
						while(liftHeight >= (desiredHeight + 2) || liftHeight <= (desiredHeight - 2) && stopLoop == false) {
								lifter.toFifth();
								lifter.getLiftInput();
							}
						stopLoop = false;
						}
					}
				};
			
			Thread liftAxisThread = new Thread() {
				public void start() {
					}
					public void run() {
						liftDriver.arcadeDrive(liftStick.getY(), liftStick.getY());
				}
			};
		
        while (isOperatorControl() && isEnabled()) {
							chassis.setSafetyEnabled(true);
							driveThread.start();
							liftThread.start();
							liftAxisThread.start();
					}
				}
										
  /**
     * This function is called once each time the robot enters test mode.
    */
    public void test() {
			
				double testHeight;
				while (isTest() && isEnabled()) {
					testHeight = liftSensor.getRangeInches();
					System.out.println(testHeight + " inches");
		}
	}
}
